(function(i,e){typeof exports=="object"&&typeof module<"u"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(i=typeof globalThis<"u"?globalThis:i||self,e(i.McbrEmbedSDK={}))})(this,function(i){"use strict";var M=Object.defineProperty;var O=i=>{throw TypeError(i)};var F=(i,e,s)=>e in i?M(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s;var d=(i,e,s)=>F(i,typeof e!="symbol"?e+"":e,s),C=(i,e,s)=>e.has(i)||O("Cannot "+s);var n=(i,e,s)=>(C(i,e,"read from private field"),s?s.call(i):e.get(i)),f=(i,e,s)=>e.has(i)?O("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,s),b=(i,e,s,k)=>(C(i,e,"write to private field"),k?k.call(i,s):e.set(i,s),s),E=(i,e,s)=>(C(i,e,"access private method"),s);var l,a,w,m,g,B,H;function e(h,t){return h==null?t:typeof h=="number"?`${h}px`:h}function s(h){if(typeof h!="string")return h;const t=document.querySelector(h);if(!t)throw new Error(`Not found container: ${h}`);return t}function k(h){try{return new URL(h,window.location.href).origin}catch{return}}class x{constructor(t){f(this,g);f(this,l);f(this,a);f(this,w);f(this,m);const o=t.origin??k(t.url)??"*";b(this,l,{container:s(t.container),url:t.url,origin:o,width:e(t.width,"100%"),height:e(t.height,"600px"),sandbox:t.sandbox??"allow-scripts allow-same-origin allow-forms allow-popups allow-modals",allow:t.allow??"clipboard-write; fullscreen; microphone; camera",params:t.params}),b(this,m,r=>E(this,g,H).call(this,r))}mount(){if(n(this,a))return this;const{container:t,url:o,width:r,height:p,sandbox:u,allow:y,params:v}=n(this,l),N=E(this,g,B).call(this,o,v),c=document.createElement("iframe");return c.src=N,c.width="0",c.height="0",c.style.width=r,c.style.height=p,c.style.border="0",c.style.display="block",u&&c.setAttribute("sandbox",u),y&&c.setAttribute("allow",y),t.appendChild(c),b(this,a,c),window.addEventListener("message",n(this,m)),this}unmount(){return n(this,a)?(window.removeEventListener("message",n(this,m)),n(this,a).remove(),b(this,a,void 0),this):this}onEvent(t){return b(this,w,t),this}send(t){if(!n(this,a)||!n(this,a).contentWindow)return!1;const o=n(this,l).origin||"*";return n(this,a).contentWindow.postMessage(t,o),!0}setSize(t,o){return n(this,a)?(n(this,a).style.width=e(t,n(this,l).width),n(this,a).style.height=e(o,n(this,l).height),this):this}get iframe(){return n(this,a)}}l=new WeakMap,a=new WeakMap,w=new WeakMap,m=new WeakMap,g=new WeakSet,B=function(t,o){if(!o)return t;const r=new URL(t,window.location.href);return Object.entries(o).forEach(([p,u])=>{u!=null&&r.searchParams.set(p,String(u))}),r.toString()},H=function(t){var p;const{origin:o}=n(this,l);if(o!=="*"&&t.origin!==o)return;const r=t.data;!r||typeof r!="object"||!("type"in r)||(p=n(this,w))==null||p.call(this,r)};class L{constructor(t={}){d(this,"backdrop");d(this,"container");d(this,"closeBtn");d(this,"isOpenFlag",!1);d(this,"opts");d(this,"keydownHandler");d(this,"backdropClickHandler");this.opts={width:t.width??"90vw",height:t.height??"90vh",maxWidth:t.maxWidth??"1200px",maxHeight:t.maxHeight??"800px",zIndex:t.zIndex??9999,backdropOpacity:t.backdropOpacity??.5,closeOnBackdrop:t.closeOnBackdrop??!0,closeOnEscape:t.closeOnEscape??!0,showCloseButton:t.showCloseButton??!0,containerClass:t.containerClass??"",backdropClass:t.backdropClass??""},this.create()}create(){this.backdrop=document.createElement("div"),this.backdrop.style.cssText=`
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, ${this.opts.backdropOpacity});
      z-index: ${this.opts.zIndex};
      display: none;
      justify-content: center;
      align-items: center;
    `,this.opts.backdropClass&&(this.backdrop.className=this.opts.backdropClass),this.container=document.createElement("div"),this.container.style.cssText=`
      position: relative;
      width: ${this.opts.width};
      height: ${this.opts.height};
      max-width: ${this.opts.maxWidth};
      max-height: ${this.opts.maxHeight};
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    `,this.opts.containerClass&&(this.container.className=this.opts.containerClass),this.container.setAttribute("role","dialog"),this.container.setAttribute("aria-modal","true"),this.opts.showCloseButton&&(this.closeBtn=document.createElement("button"),this.closeBtn.type="button",this.closeBtn.innerHTML="âœ•",this.closeBtn.style.cssText=`
        position: absolute;
        top: 10px;
        right: 10px;
        width: 30px;
        height: 30px;
        border: none;
        background-color: rgba(0, 0, 0, 0.1);
        color: #666;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        border-radius: 50%;
        z-index: ${this.opts.zIndex+2};
        display: flex;
        align-items: center;
        justify-content: center;
      `,this.closeBtn.addEventListener("click",()=>this.close()),this.closeBtn.addEventListener("mouseenter",()=>{this.closeBtn&&(this.closeBtn.style.backgroundColor="rgba(0, 0, 0, 0.2)")}),this.closeBtn.addEventListener("mouseleave",()=>{this.closeBtn&&(this.closeBtn.style.backgroundColor="rgba(0, 0, 0, 0.1)")}),this.container.appendChild(this.closeBtn)),this.opts.closeOnBackdrop&&(this.backdropClickHandler=t=>{t.target===this.backdrop&&this.close()},this.backdrop.addEventListener("click",this.backdropClickHandler)),this.opts.closeOnEscape&&(this.keydownHandler=t=>{t.key==="Escape"&&this.isOpenFlag&&this.close()},document.addEventListener("keydown",this.keydownHandler)),this.backdrop.appendChild(this.container),document.body.appendChild(this.backdrop)}getContainer(){return this.container}open(){this.isOpenFlag||(this.isOpenFlag=!0,this.backdrop.style.display="flex",document.body.style.overflow="hidden")}close(){this.isOpenFlag&&(this.isOpenFlag=!1,this.backdrop.style.display="none",document.body.style.overflow="")}toggle(){this.isOpenFlag?this.close():this.open()}isOpen(){return this.isOpenFlag}destroy(){this.close(),this.backdropClickHandler&&this.backdrop.removeEventListener("click",this.backdropClickHandler),this.keydownHandler&&document.removeEventListener("keydown",this.keydownHandler),this.backdrop.remove()}}class z{constructor({clientId:t,email:o,firstName:r,lastName:p,theme:u}){d(this,"instance");d(this,"modal");d(this,"clientId");d(this,"email");d(this,"firstName");d(this,"lastName");d(this,"theme");this.modal=new L({width:"90vw",height:"90vh",maxWidth:"1200px",maxHeight:"800px",closeOnBackdrop:!0,closeOnEscape:!0,showCloseButton:!0,zIndex:9999});const y="https://staging.mcr-staging.xyz",v=new URL(y).origin;this.instance=new x({container:this.modal.getContainer(),url:y,origin:v,width:"100%",height:"100%",clientId:t}),this.clientId=t,this.email=o,this.firstName=r,this.lastName=p,this.theme=u}open(){this.modal.isOpen()||(this.modal.open(),this.instance.iframe||this.instance.mount())}close(){this.modal.isOpen()&&this.modal.close()}init(t,o){var r;(r=this.instance)==null||r.unmount(),this.instance=new x({container:this.modal.getContainer(),url:t||"https://staging.mcr-staging.xyz",origin:o||new URL(t||"https://staging.mcr-staging.xyz").origin,width:"100%",height:"100%",clientId:""}),this.modal.isOpen()&&this.instance.mount()}auth(){this.theme&&this.instance.send({type:"host:theme",payload:{theme:this.theme}}),this.instance.send({type:"host:partner-auth",payload:{email:this.email,firstName:this.firstName,lastName:this.lastName,clientId:this.clientId}})}setTheme(t){this.instance.send({type:"host:theme",payload:{theme:t}})}onEvent(t){this.instance.onEvent(t)}isModalOpen(){return this.modal.isOpen()}toggle(){this.modal.isOpen()?this.close():this.open()}destroy(){var t;this.close(),(t=this.instance)==null||t.unmount(),this.modal.destroy()}}try{typeof window<"u"&&(window.McbrEmbedSDK={WebEmbed:x},window.MCRSDK=z)}catch{}i.WebEmbed=x,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=mcbr-embed-sdk.umd.js.map
