{"version":3,"file":"mcbr-embed-sdk.es.js","sources":["../src/embed.ts","../src/ui/modal.ts","../src/sdk.ts","../src/index.ts"],"sourcesContent":["import {\n  WebEmbedOptions as WebEmbedOptions,\n  EventHandler,\n  HostToIframeEvents,\n  IframeToHostEvents,\n} from \"./types\";\n\ntype ResolvedOptions = {\n  container: HTMLElement;\n  url: string;\n  origin: string; // '*' or a specific origin\n  width: string; // normalized\n  height: string; // normalized\n  sandbox: string;\n  allow: string;\n  params?: Record<string, string | number | boolean | undefined | null>;\n};\n\nfunction normalizeSize(\n  v: string | number | undefined,\n  fallback: string\n): string {\n  if (v === undefined || v === null) return fallback;\n  return typeof v === \"number\" ? `${v}px` : v;\n}\n\nfunction resolveContainer(elOrSelector: HTMLElement | string): HTMLElement {\n  if (typeof elOrSelector !== \"string\") return elOrSelector;\n  const el = document.querySelector(elOrSelector);\n  if (!el) throw new Error(`Not found container: ${elOrSelector}`);\n  return el as HTMLElement;\n}\n\nfunction deriveOriginFromUrl(url: string): string | undefined {\n  try {\n    const u = new URL(url, window.location.href);\n    return u.origin;\n  } catch {\n    return undefined;\n  }\n}\n\nexport class WebEmbed {\n  #opts: ResolvedOptions;\n  #iframe?: HTMLIFrameElement;\n  #onEvent?: EventHandler;\n  #boundListener: (e: MessageEvent) => void;\n\n  constructor(opts: WebEmbedOptions) {\n    const origin = opts.origin ?? deriveOriginFromUrl(opts.url) ?? \"*\";\n    this.#opts = {\n      container: resolveContainer(opts.container),\n      url: opts.url,\n      origin,\n      width: normalizeSize(opts.width, \"100%\"),\n      height: normalizeSize(opts.height, \"600px\"),\n      sandbox:\n        opts.sandbox ??\n        \"allow-scripts allow-same-origin allow-forms allow-popups allow-modals\",\n      allow: opts.allow ?? \"clipboard-write; fullscreen; microphone; camera\",\n      params: opts.params\n    };\n\n    this.#boundListener = (e: MessageEvent) => this.#handleMessage(e);\n  }\n\n  mount() {\n    if (this.#iframe) return this;\n    const { container, url, width, height, sandbox, allow, params } =\n      this.#opts;\n\n    const src = this.#buildUrl(url, params);\n    const iframe = document.createElement(\"iframe\");\n    iframe.src = src;\n    iframe.width = \"0\"; // managed by style\n    iframe.height = \"0\";\n    iframe.style.width = width;\n    iframe.style.height = height;\n    iframe.style.border = \"0\";\n    iframe.style.display = \"block\";\n    if (sandbox) iframe.setAttribute(\"sandbox\", sandbox);\n    if (allow) iframe.setAttribute(\"allow\", allow);\n    container.appendChild(iframe);\n\n    this.#iframe = iframe;\n    window.addEventListener(\"message\", this.#boundListener);\n    return this;\n  }\n\n  unmount() {\n    if (!this.#iframe) return this;\n    window.removeEventListener(\"message\", this.#boundListener);\n    this.#iframe.remove();\n    this.#iframe = undefined;\n    return this;\n  }\n\n  onEvent(handler: EventHandler) {\n    this.#onEvent = handler;\n    return this;\n  }\n\n  send(event: HostToIframeEvents) {\n    if (!this.#iframe || !this.#iframe.contentWindow) return false;\n    const targetOrigin = this.#opts.origin || \"*\";\n    this.#iframe.contentWindow.postMessage(event, targetOrigin);\n    return true;\n  }\n\n  setSize(width?: string | number, height?: string | number) {\n    if (!this.#iframe) return this;\n    this.#iframe.style.width = normalizeSize(width, this.#opts.width);\n    this.#iframe.style.height = normalizeSize(height, this.#opts.height);\n    return this;\n  }\n\n  get iframe(): HTMLIFrameElement | undefined {\n    return this.#iframe;\n  }\n\n  #buildUrl(url: string, params?: Record<string, any>) {\n    if (!params) return url;\n    const u = new URL(url, window.location.href);\n    Object.entries(params).forEach(([k, v]) => {\n      if (v === undefined || v === null) return;\n      u.searchParams.set(k, String(v));\n    });\n    return u.toString();\n  }\n\n  #handleMessage(e: MessageEvent) {\n    const { origin } = this.#opts;\n    if (origin !== \"*\" && e.origin !== origin) return;\n\n    const data = e.data as IframeToHostEvents | undefined;\n    if (!data || typeof data !== \"object\" || !(\"type\" in data)) return;\n\n    this.#onEvent?.(data as IframeToHostEvents);\n  }\n}\n","export type ModalOptions = {\n  width?: string;\n  height?: string;\n  maxWidth?: string;\n  maxHeight?: string;\n  zIndex?: number;\n  backdropOpacity?: number;\n  closeOnBackdrop?: boolean;\n  closeOnEscape?: boolean;\n  showCloseButton?: boolean;\n  containerClass?: string;\n  backdropClass?: string;\n};\n\nexport class Modal {\n  private backdrop!: HTMLDivElement;\n  private container!: HTMLDivElement;\n  private closeBtn?: HTMLButtonElement;\n\n  private isOpenFlag = false;\n  private opts: Required<ModalOptions>;\n\n  private keydownHandler?: (e: KeyboardEvent) => void;\n  private backdropClickHandler?: (e: MouseEvent) => void;\n\n  constructor(options: ModalOptions = {}) {\n    this.opts = {\n      width: options.width ?? \"90vw\",\n      height: options.height ?? \"90vh\",\n      maxWidth: options.maxWidth ?? \"1200px\",\n      maxHeight: options.maxHeight ?? \"800px\",\n      zIndex: options.zIndex ?? 9999,\n      backdropOpacity: options.backdropOpacity ?? 0.5,\n      closeOnBackdrop: options.closeOnBackdrop ?? true,\n      closeOnEscape: options.closeOnEscape ?? true,\n      showCloseButton: options.showCloseButton ?? true,\n      containerClass: options.containerClass ?? \"\",\n      backdropClass: options.backdropClass ?? \"\",\n    };\n\n    this.create();\n  }\n\n  private create() {\n    // Backdrop\n    this.backdrop = document.createElement(\"div\");\n    this.backdrop.style.cssText = `\n      position: fixed;\n      inset: 0;\n      width: 100vw;\n      height: 100vh;\n      background-color: rgba(0, 0, 0, ${this.opts.backdropOpacity});\n      z-index: ${this.opts.zIndex};\n      display: none;\n      justify-content: center;\n      align-items: center;\n    `;\n    if (this.opts.backdropClass) {\n      this.backdrop.className = this.opts.backdropClass;\n    }\n\n    // Container\n    this.container = document.createElement(\"div\");\n    this.container.style.cssText = `\n      position: relative;\n      width: ${this.opts.width};\n      height: ${this.opts.height};\n      max-width: ${this.opts.maxWidth};\n      max-height: ${this.opts.maxHeight};\n      background-color: white;\n      border-radius: 8px;\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n      overflow: hidden;\n    `;\n    if (this.opts.containerClass) {\n      this.container.className = this.opts.containerClass;\n    }\n    this.container.setAttribute(\"role\", \"dialog\");\n    this.container.setAttribute(\"aria-modal\", \"true\");\n\n    // Close button\n    if (this.opts.showCloseButton) {\n      this.closeBtn = document.createElement(\"button\");\n      this.closeBtn.type = \"button\";\n      this.closeBtn.innerHTML = \"âœ•\";\n      this.closeBtn.style.cssText = `\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        width: 30px;\n        height: 30px;\n        border: none;\n        background-color: rgba(0, 0, 0, 0.1);\n        color: #666;\n        font-size: 18px;\n        font-weight: bold;\n        cursor: pointer;\n        border-radius: 50%;\n        z-index: ${this.opts.zIndex + 2};\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      `;\n      this.closeBtn.addEventListener(\"click\", () => this.close());\n      this.closeBtn.addEventListener(\"mouseenter\", () => {\n        if (this.closeBtn)\n          this.closeBtn.style.backgroundColor = \"rgba(0, 0, 0, 0.2)\";\n      });\n      this.closeBtn.addEventListener(\"mouseleave\", () => {\n        if (this.closeBtn)\n          this.closeBtn.style.backgroundColor = \"rgba(0, 0, 0, 0.1)\";\n      });\n      this.container.appendChild(this.closeBtn);\n    }\n\n    // Events\n    if (this.opts.closeOnBackdrop) {\n      this.backdropClickHandler = (e: MouseEvent) => {\n        if (e.target === this.backdrop) this.close();\n      };\n      this.backdrop.addEventListener(\"click\", this.backdropClickHandler);\n    }\n\n    if (this.opts.closeOnEscape) {\n      this.keydownHandler = (e: KeyboardEvent) => {\n        if (e.key === \"Escape\" && this.isOpenFlag) this.close();\n      };\n      document.addEventListener(\"keydown\", this.keydownHandler);\n    }\n\n    this.backdrop.appendChild(this.container);\n    document.body.appendChild(this.backdrop);\n  }\n\n  getContainer(): HTMLElement {\n    return this.container;\n  }\n\n  open() {\n    if (this.isOpenFlag) return;\n    this.isOpenFlag = true;\n    this.backdrop.style.display = \"flex\";\n    // Prevent background scroll\n    document.body.style.overflow = \"hidden\";\n  }\n\n  close() {\n    if (!this.isOpenFlag) return;\n    this.isOpenFlag = false;\n    this.backdrop.style.display = \"none\";\n    // Restore scroll\n    document.body.style.overflow = \"\";\n  }\n\n  toggle() {\n    this.isOpenFlag ? this.close() : this.open();\n  }\n\n  isOpen(): boolean {\n    return this.isOpenFlag;\n  }\n\n  destroy() {\n    this.close();\n    if (this.backdropClickHandler) {\n      this.backdrop.removeEventListener(\"click\", this.backdropClickHandler);\n    }\n    if (this.keydownHandler) {\n      document.removeEventListener(\"keydown\", this.keydownHandler);\n    }\n    this.backdrop.remove();\n  }\n}\n","import { WebEmbed } from \"./embed\";\nimport { Modal } from \"./ui/modal\";\n\nexport class MCRSDK {\n  instance!: WebEmbed;\n  private modal: Modal;\n\n  private clientId: string;\n  private email: string;\n  private firstName: string;\n  private lastName: string;\n  private theme: any;\n\n  constructor({\n    clientId,\n    email,\n    firstName,\n    lastName,\n    theme,\n  }: {\n    clientId: string;\n    email: string;\n    firstName: string;\n    lastName: string;\n    theme?: any;\n  }) {\n    this.modal = new Modal({\n      width: \"90vw\",\n      height: \"90vh\",\n      maxWidth: \"1200px\",\n      maxHeight: \"800px\",\n      closeOnBackdrop: true,\n      closeOnEscape: true,\n      showCloseButton: true,\n      zIndex: 9999,\n    });\n\n    const url = \"https://staging.mcr-staging.xyz\";\n    // https://staging.mcr-staging.xyz\n\n    const origin = new URL(url).origin;\n\n    this.instance = new WebEmbed({\n      container: this.modal.getContainer(),\n      url,\n      origin,\n      width: \"100%\",\n      height: \"100%\",\n      clientId,\n    });\n\n    this.clientId = clientId;\n    this.email = email;\n    this.firstName = firstName;\n    this.lastName = lastName;\n    this.theme = theme;\n  }\n\n  open() {\n    if (this.modal.isOpen()) return;\n    this.modal.open();\n    if (!this.instance.iframe) {\n      this.instance.mount();\n    }\n  }\n\n  close() {\n    if (!this.modal.isOpen()) return;\n    this.modal.close();\n  }\n\n  init(frameUrl?: string, origin?: string) {\n    this.instance?.unmount();\n    this.instance = new WebEmbed({\n      container: this.modal.getContainer(),\n      url: frameUrl || \"https://staging.mcr-staging.xyz\",\n      origin:\n        origin || new URL(frameUrl || \"https://staging.mcr-staging.xyz\").origin,\n      width: \"100%\",\n      height: \"100%\",\n      clientId: \"\",\n    });\n    if (this.modal.isOpen()) {\n      this.instance.mount();\n    }\n  }\n\n  auth() {\n    if (this.theme) {\n      this.instance.send({\n        type: \"host:theme\",\n        payload: { theme: this.theme },\n      });\n    }\n\n    this.instance.send({\n      type: \"host:partner-auth\",\n      payload: {\n        email: this.email,\n        firstName: this.firstName,\n        lastName: this.lastName,\n        clientId: this.clientId,\n      },\n    });\n  }\n\n  setTheme(theme: \"light\" | \"dark\") {\n    this.instance.send({\n      type: \"host:theme\",\n      payload: { theme },\n    });\n  }\n\n  onEvent(handler: (event: any) => void) {\n    this.instance.onEvent(handler);\n  }\n\n  isModalOpen(): boolean {\n    return this.modal.isOpen();\n  }\n\n  toggle() {\n    if (this.modal.isOpen()) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  destroy() {\n    this.close();\n    this.instance?.unmount();\n    this.modal.destroy();\n  }\n}\n","import { WebEmbed } from \"./embed\";\nimport { MCRSDK } from \"./sdk\";\nexport { WebEmbed };\nexport type {\n  WebEmbedOptions,\n  HostToIframeEvents,\n  IframeToHostEvents,\n  EventHandler,\n} from \"./types\";\n\ndeclare global {\n  interface Window {\n    McbrEmbedSDK?: { WebEmbed: typeof WebEmbed };\n    MCRSDK?: typeof MCRSDK;\n  }\n}\n\ntry {\n  if (typeof window !== \"undefined\") {\n    window.McbrEmbedSDK = { WebEmbed };\n    window.MCRSDK = MCRSDK;\n  }\n} catch {}\n"],"names":["normalizeSize","v","fallback","resolveContainer","elOrSelector","el","deriveOriginFromUrl","url","_opts","_iframe","_onEvent","_boundListener","_WebEmbed_instances","buildUrl_fn","handleMessage_fn","WebEmbed","opts","__privateAdd","origin","__privateSet","e","__privateMethod","__privateGet","container","width","height","sandbox","allow","params","src","iframe","handler","event","targetOrigin","u","k","_a","data","Modal","options","__publicField","MCRSDK","clientId","email","firstName","lastName","theme","frameUrl"],"mappings":"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"}